<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organizer Dashboard - EventHub</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
</head>
<body class="dashboard-body">
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <a href="#" class="brand">
                <i class="fas fa-bolt"></i>
                <span>EventHub</span>
            </a>
            <button class="sidebar-toggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <ul class="sidebar-menu">
            <li class="menu-item active">
                <a href="#dashboard">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#events">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Events</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#analytics">
                    <i class="fas fa-chart-line"></i>
                    <span>Analytics</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#attendees">
                    <i class="fas fa-users"></i>
                    <span>Attendees</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#reports">
                    <i class="fas fa-file-alt"></i>
                    <span>Reports</span>
                </a>
            </li>
            <li class="menu-item">
                <a href="#settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Main Content Area -->
    <main class="main-content">
        <!-- Top Navigation Bar -->
        <nav class="top-nav">
            <div class="nav-container">
                <div class="nav-left">
                    <button id="sidebar-toggle" class="menu-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="nav-brand">
                        <img src="assets/images/logo.png" alt="EventHub" class="nav-logo">
                        <span class="brand-name">EventHub</span>
                    </div>
                    <div class="search-container">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" placeholder="Search events, attendees...">
                            <div class="search-suggestions">
                                <div class="suggestion-group">
                                    <h6>Recent Searches</h6>
                                    <a href="#" class="suggestion-item">
                                        <i class="fas fa-history"></i>
                                        Tech Conference 2024
                                    </a>
                                    <a href="#" class="suggestion-item">
                                        <i class="fas fa-history"></i>
                                        Music Festival
                                    </a>
                                </div>
                                <div class="suggestion-group">
                                    <h6>Popular Searches</h6>
                                    <a href="#" class="suggestion-item">
                                        <i class="fas fa-fire"></i>
                                        Upcoming Events
                                    </a>
                                    <a href="#" class="suggestion-item">
                                        <i class="fas fa-fire"></i>
                                        Trending Events
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="nav-right">
                    <div class="nav-actions">
                        <button class="create-event-btn" onclick="showCreateEventModal()">
                            <i class="fas fa-plus"></i>
                            <span>Create Event</span>
                        </button>

                        <div class="notifications-dropdown">
                            <button class="icon-btn" onclick="toggleNotifications()">
                                <i class="fas fa-bell"></i>
                                <span class="notification-badge">3</span>
                            </button>
                            <div class="dropdown-content notifications-menu" id="notificationsDropdown">
                                <div class="dropdown-header">
                                    <h3>Notifications</h3>
                                    <button class="mark-all-read">Mark all as read</button>
                                </div>
                                <div class="notification-list">
                                    <div class="notification-item unread">
                                        <div class="notification-icon">
                                            <i class="fas fa-ticket-alt"></i>
                                        </div>
                                        <div class="notification-content">
                                            <p>New ticket purchased for <strong>Tech Conference 2024</strong></p>
                                            <span class="notification-time">5 minutes ago</span>
                                        </div>
                                        <button class="notification-action">
                                            <i class="fas fa-ellipsis-v"></i>
                                        </button>
                                    </div>
                                    <div class="notification-item">
                                        <div class="notification-icon">
                                            <i class="fas fa-user-plus"></i>
                                        </div>
                                        <div class="notification-content">
                                            <p>New registration for <strong>Summer Music Festival</strong></p>
                                            <span class="notification-time">1 hour ago</span>
                                        </div>
                                        <button class="notification-action">
                                            <i class="fas fa-ellipsis-v"></i>
                                        </button>
                                    </div>
                                    <div class="notification-item">
                                        <div class="notification-icon">
                                            <i class="fas fa-comment"></i>
                                        </div>
                                        <div class="notification-content">
                                            <p>New review for <strong>Sports Championship</strong></p>
                                            <span class="notification-time">2 hours ago</span>
                                        </div>
                                        <button class="notification-action">
                                            <i class="fas fa-ellipsis-v"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="dropdown-footer">
                                    <a href="#" class="view-all">View all notifications</a>
                                </div>
                            </div>
                        </div>

                        <div class="user-dropdown">
                            <button class="user-btn" onclick="toggleUserMenu()">
                                <img src="assets/images/profile-placeholder.jpg" alt="Profile" class="user-avatar">
                                <div class="user-info">
                                    <span class="user-name">John Doe</span>
                                    <span class="user-role">Event Organizer</span>
                                </div>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="dropdown-content user-menu" id="userDropdown">
                                <div class="user-header">
                                    <img src="assets/images/profile-placeholder.jpg" alt="Profile" class="user-avatar-large">
                                    <div class="user-details">
                                        <h4>John Doe</h4>
                                        <span>john.doe@example.com</span>
                                    </div>
                                </div>
                                <div class="dropdown-divider"></div>
                                <a href="#" class="dropdown-item">
                                    <i class="fas fa-user"></i>
                                    My Profile
                                </a>
                                <a href="#" class="dropdown-item">
                                    <i class="fas fa-calendar"></i>
                                    My Events
                                </a>
                                <a href="#" class="dropdown-item">
                                    <i class="fas fa-cog"></i>
                                    Settings
                                </a>
                                <a href="#" class="dropdown-item">
                                    <i class="fas fa-question-circle"></i>
                                    Help Center
                                </a>
                                <div class="dropdown-divider"></div>
                                <a href="#" class="dropdown-item text-danger">
                                    <i class="fas fa-sign-out-alt"></i>
                                    Logout
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Dashboard Content -->
        <div class="dashboard-content">
            <!-- Welcome Banner -->
            <section class="welcome-banner">
                <div class="banner-content">
                    <h1>Welcome Back, <span id="welcomeUserName">John!</span></h1>
                    <p>Here's what's happening with your events today</p>
                </div>
                <div class="banner-image">
                    <img src="assets/images/dashboard-illustration.svg" alt="Dashboard">
                </div>
            </section>

            <!-- Quick Stats -->
            <section class="stats-grid">
                <div class="stat-card primary">
                    <div class="stat-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="stat-details">
                        <h3>Total Events</h3>
                        <h2>15</h2>
                        <p class="trend positive">
                            <i class="fas fa-arrow-up"></i>
                            12% increase
                        </p>
                    </div>
                </div>

                <div class="stat-card success">
                    <div class="stat-icon">
                        <i class="fas fa-ticket-alt"></i>
                    </div>
                    <div class="stat-details">
                        <h3>Tickets Sold</h3>
                        <h2>250</h2>
                        <p class="trend positive">
                            <i class="fas fa-arrow-up"></i>
                            8% increase
                        </p>
                    </div>
                </div>

                <div class="stat-card info">
                    <div class="stat-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-details">
                        <h3>Revenue</h3>
                        <h2>$12,500</h2>
                        <p class="trend positive">
                            <i class="fas fa-arrow-up"></i>
                            15% increase
                        </p>
                    </div>
                </div>

                <div class="stat-card warning">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-details">
                        <h3>Attendees</h3>
                        <h2>180</h2>
                        <p class="trend positive">
                            <i class="fas fa-arrow-up"></i>
                            10% increase
                        </p>
                    </div>
                </div>
            </section>

            <!-- Recent Events -->
            <section class="recent-events">
                <div class="section-header">
                    <h2>Recent Events</h2>
                    <a href="#events" class="view-all">View All</a>
                </div>
                <div class="events-grid" id="recentEvents">
                    <!-- Events will be loaded dynamically -->
                </div>
            </section>

            <!-- Analytics Overview -->
            <section class="analytics-overview">
                <div class="section-header">
                    <h2>Analytics Overview</h2>
                    <div class="date-filter">
                        <button class="active">Weekly</button>
                        <button>Monthly</button>
                        <button>Yearly</button>
                    </div>
                </div>
                <div class="analytics-grid">
                    <div class="chart-card">
                        <h3>Ticket Sales</h3>
                        <canvas id="ticketSalesChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>Revenue</h3>
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Create Event Modal -->
    <div class="modal fade" id="createEventModal" tabindex="-1" aria-labelledby="createEventModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="createEventModalLabel">Create New Event</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="createEventForm" class="create-event-form">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="eventTitle">Event Title</label>
                                    <input type="text" class="form-control" id="eventTitle" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="eventCategory">Category</label>
                                    <select class="form-control" id="eventCategory" required>
                                        <option value="">Select Category</option>
                                        <option value="tech">Technology</option>
                                        <option value="music">Music</option>
                                        <option value="sports">Sports</option>
                                        <option value="business">Business</option>
                                        <option value="art">Art & Culture</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="row mt-3">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="eventDate">Date</label>
                                    <input type="date" class="form-control" id="eventDate" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="eventTime">Time</label>
                                    <input type="time" class="form-control" id="eventTime" required>
                                </div>
                            </div>
                        </div>

                        <div class="form-group mt-3">
                            <label for="eventLocation">Location</label>
                            <input type="text" class="form-control" id="eventLocation" required>
                        </div>

                        <div class="form-group mt-3">
                            <label for="eventDescription">Description</label>
                            <textarea class="form-control" id="eventDescription" rows="4" required></textarea>
                        </div>

                        <div class="row mt-3">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="eventPrice">Price ($)</label>
                                    <input type="number" class="form-control" id="eventPrice" min="0" step="0.01" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="eventCapacity">Capacity</label>
                                    <input type="number" class="form-control" id="eventCapacity" min="1" required>
                                </div>
                            </div>
                        </div>

                        <div class="form-group mt-3">
                            <label for="eventImage">Event Image</label>
                            <input type="file" class="form-control" id="eventImage" accept="image/*" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="createEvent()">Create Event</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/auth.js"></script>
    <script>
        let createEventModal;

        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Bootstrap modal
            createEventModal = new bootstrap.Modal(document.getElementById('createEventModal'));

            // Check authentication
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');

            if (!isLoggedIn || currentUser.userType !== 'organizer') {
                window.location.href = 'index.html';
                return;
            }

            // Update user information
            document.getElementById('userName').textContent = currentUser.fullName;
            loadUserProfile(currentUser);
            loadEvents();
            initializeCharts();
        });

        function handleLogout() {
            localStorage.removeItem('currentUser');
            localStorage.removeItem('isLoggedIn');
            window.location.href = 'index.html';
        }

        function showSection(sectionId) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('d-none');
            });
            document.getElementById(sectionId).classList.remove('d-none');
            
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + sectionId) {
                    link.classList.add('active');
                }
            });
        }

        function loadUserProfile(user) {
            document.getElementById('profileName').value = user.fullName || '';
            document.getElementById('profileEmail').value = user.email || '';
            document.getElementById('profilePhone').value = user.phone || '';
            document.getElementById('profileDescription').value = user.description || '';
        }

        function loadEvents() {
            // Sample events data
            const events = [
                {
                    id: 1,
                    title: 'Tech Conference 2024',
                    date: '2024-01-15',
                    location: 'San Francisco, CA',
                    ticketsSold: 150,
                    revenue: 7500
                },
                {
                    id: 2,
                    title: 'Music Festival',
                    date: '2024-02-01',
                    location: 'Austin, TX',
                    ticketsSold: 100,
                    revenue: 5000
                }
            ];

            const eventsList = document.getElementById('eventsList');
            eventsList.innerHTML = events.map(event => `
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">${event.title}</h5>
                            <p class="card-text">
                                <i class="fas fa-calendar"></i> ${event.date}<br>
                                <i class="fas fa-map-marker-alt"></i> ${event.location}<br>
                                <i class="fas fa-ticket-alt"></i> ${event.ticketsSold} tickets sold<br>
                                <i class="fas fa-dollar-sign"></i> $${event.revenue} revenue
                            </p>
                            <button class="btn btn-primary me-2" onclick="editEvent(${event.id})">Edit</button>
                            <button class="btn btn-danger" onclick="deleteEvent(${event.id})">Delete</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function showCreateEventModal() {
            createEventModal.show();
        }

        function initializeCharts() {
            // Ticket Sales Chart
            const ticketSalesCtx = document.getElementById('ticketSalesChart').getContext('2d');
            new Chart(ticketSalesCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Ticket Sales',
                        data: [65, 59, 80, 81, 56, 55],
                        fill: false,
                        borderColor: '#FFB347',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });

            // Revenue Chart
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            new Chart(revenueCtx, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Revenue',
                        data: [4500, 5900, 8000, 8100, 5600, 5500],
                        backgroundColor: '#FF69B4'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });

            // Event Performance Chart
            const performanceCtx = document.getElementById('eventPerformanceChart').getContext('2d');
            new Chart(performanceCtx, {
                type: 'bar',
                data: {
                    labels: ['Tech Conference', 'Music Festival', 'Art Exhibition'],
                    datasets: [{
                        label: 'Tickets Sold',
                        data: [150, 100, 75],
                        backgroundColor: '#4CAF50'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });

            // Demographics Chart
            const demographicsCtx = document.getElementById('demographicsChart').getContext('2d');
            new Chart(demographicsCtx, {
                type: 'pie',
                data: {
                    labels: ['18-24', '25-34', '35-44', '45+'],
                    datasets: [{
                        data: [30, 40, 20, 10],
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });
        }

        // Handle form submissions
        document.getElementById('profileForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
            user.fullName = document.getElementById('profileName').value;
            user.email = document.getElementById('profileEmail').value;
            user.phone = document.getElementById('profilePhone').value;
            user.description = document.getElementById('profileDescription').value;
            localStorage.setItem('currentUser', JSON.stringify(user));
            document.getElementById('userName').textContent = user.fullName;
            alert('Profile updated successfully!');
        });

        document.getElementById('settingsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Settings saved successfully!');
        });

        document.getElementById('createEventForm').addEventListener('submit', function(e) {
            e.preventDefault();
            // Here you would typically send this data to your backend
            alert('Event created successfully!');
            createEventModal.hide();
            loadEvents(); // Reload events list
        });

        function editEvent(eventId) {
            alert('Editing event ' + eventId);
        }

        function deleteEvent(eventId) {
            if (confirm('Are you sure you want to delete this event?')) {
                alert('Event ' + eventId + ' deleted successfully');
                loadEvents(); // Reload events list
            }
        }
    </script>
</body>
</html>
